---
slug: '2019-12-23_debug_com_window-ng_no_angular_9'
title: 'Debug de componentes Angular com window.ng no Angular 9'
date: '2019-12-23'
author: 'Ra√≠ Siqueira'
published: true
description: 'Com a vers√£o 9 do Angular prestes a sair, temos algumas novas features que v√£o nos ajudar a desenvolver nossas aplica√ß√µes e tamb√©m a debugar-las de maneira certa, e uma dessas novidades √© o objeto global window.ng.'
categories:
  - 'javascript'
  - 'angular'
banner: './images/banner.png'
bannerCredit: 'window.ng console output'
---
![console browser](./images/banner.png "console browser")

Com a vers√£o 9 do Angular prestes a sair, temos algumas novas features que v√£o nos ajudar a desenvolver nossas aplica√ß√µes e tamb√©m a debugar-las de maneira certa, e uma dessas novidades √© o objeto global `window.ng`.

## `window.ng`

Com o `window.ng` conseguimos ter acesso direto a Diretivas, Componentes entre outras features do Angular direto do console do browser, tudo isso com o Angular 9 e a nova api do [Ivy](https://angular.io/guide/ivy).

Para fazer nosso teste vamos precisar na √∫ltima `RC` do Angular (9.0.0-rc.7 at√© o momento deste post). Vamos criar um novo projeto com Angular 9:

![install next version of Angular](./images/angular-install-v9.png "install next version of Angular")

## Conhecendo a nova API do `window.ng`

Ok, com nosso projeto rodando vamos conhecer como que a api do `window.ng` funciona com alguns exemplos, o primeiro e o mais importante √© o `ng.getComponent()`.

![Angular componente](./images/angular-component-01.png "Angular componente")

Com o nosso componente criado, vamos atualizar o valor do atributo `title` do nosso componente, para isso precisamos acessar o `HTMLElement ` do componente, para isso vamos usar a fun√ß√£o do Chrome `$(selector)` e armazenar em uma vari√°vel, `el`. A fun√ß√£o `ng.getComponent()` recebe um elemento, neste caso vamos usar o elemento que est√° armazenado na vari√°vel `el`, com isso j√° conseguimos atualizar o valor do atributo _title_ do nosso componente.

```js
// armazena o elemento em uma vari√°vel
const el = $('app-root');
// invoca a fun√ß√£o getComponent() passando o elemento armazenado
const c = ng.getComponent(el);
// atualiza o valor do atributo title do componente
c.title = 'Hey new ng api!!!';
// invoca o change detector do Angular
ng.markDirty(el);
```

Exemplo:

![live demo](https://res.cloudinary.com/dwc5hkby0/image/upload/v1577148580/rs-blog-posts/ng-component-ng-api.gif "live demo 1")

### Casos de uso para o `ng.getComponent()`

- Acessar um service injetado no componente e disparar algum m√©todo do mesmo manualmente e acessar os valores via console;
- Fazer um subscribe em algum Observable e emitir o valor tamb√©m no console;
- Acessar algum m√©todo do pr√≥prio componente e analisar se o comportamento est√° como esperado.

## `ng.markDirty()`

Voc√™ deve ter notado que no final do √∫ltimo exemplo usamos o m√©todo `markDirty()`. Essa fun√ß√£o √© importante ao debugar usando o console, ela √© respons√°vel por chamar a API de _change detector_ do Angular e fazer as devidas altera√ß√µes no componente especificado, mais uma vez vamos usar o nosso exemplo:

```js
// armazena o elemento em uma vari√°vel
const el = $('app-root');
// invoca a fun√ß√£o getComponent() passando o elemento armazenado
const c = ng.getComponent(el);
// atualiza o valor do atributo title do componente
c.title = 'Hey new ng api!!!';
// invoca o change detector do Angular
ng.markDirty(el);
```

Ao invocar o o `markDirty()` nos estamos dizendo ao Angular para atualizar o estado do componente, com isso podemos especificar uma inst√¢ncia de algum componente e acionar o _change detector_.

## Conclus√£o

Com a nova API vamos interagir rapidamente com os componentes e testar as coisas sem precisar ir e voltar entre o editor e o navegador, com isso novas extens√µes de desenvolvimento podem ser desenvolvidas sobre essas APIs para facilitar ainda mais nossa vida. ü•≥
